<p-dialog appendTo="body" [(visible)]="visible" [modal]="true" styleClass="custom-header-naranja" [closable]="true"
  [maximizable]="true" [style]="{
    width: maximized ? '100vw' : '75rem', height: maximized ? '100vh' : '40rem'}" [ngClass]="{'maximized': maximized}"
  (onHide)="close()" (onShow)="onDialogShow()" class="bodyDialog">

  <ng-template pTemplate="header">
    <label class="margen">
      {{ 'ANÁLISIS DE ESTANCAMIENTO ' }}
    </label>
  </ng-template>

    <div *ngIf="!loading && !error && estancamientos.length > 0" class="table-container">
      <div class="table-responsive">
        <table class="estancamiento-table">
          <thead>
            <tr>
              <th>ID</th>
              <th>Oportunidad</th>
              <th>Etapa</th>
              <th>Días Funnel</th>
              <th>Riesgo</th>
              <th>Score Estanc.</th>
              <th>Prob. Estancada</th>
              <th>Z-Score</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of estancamientos" [class.high-risk]="item.riesgo >= 80">
              <td>{{ item.idOportunidad }}</td>
              <td class="oportunidad-name">{{ item.oportunidad }}</td>
              <td>{{ item.etapa }}</td>
              <td>{{ item.diasFunnel }}</td>
              <td>
                <span class="riesgo-badge" [ngClass]="getRiesgoClass(item.riesgo)">
                  {{ item.riesgo }}%
                </span>
              </td>
              <td>
                <span class="score-badge" [ngClass]="getScoreClass(item.scoreEstancamiento)">
                  {{ item.scoreEstancamiento }}
                </span>
              </td>
              <td>{{ item.probEstancada | number:'1.2-2' }}</td>
              <td>{{ item.zScoreFunnel | number:'1.2-2' }}</td>
              <td></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
